<div class="item-card" (click)="onCardClick()">
  <div class="item-image">
    <img 
      [src]="item.images && item.images.length > 0 ? item.images[0] : getDefaultImage()" 
      [alt]="item.name"
      (error)="onImageError($event)"
      loading="lazy"
    />
  </div>
  
  <div class="item-content">
    <!-- Rating Section - at top -->
    <div class="item-rating">
      <div class="rating-left">
        <div class="stars">
          <span 
            *ngFor="let star of [1,2,3,4,5]" 
            class="star"
            [class.filled]="star <= getRating()"
            [class.empty]="star > getRating()">
            ★
          </span>
        </div>
        <span class="rating-value">{{getRating() | number:'1.1-1'}}</span>
      </div>
      <span class="availability-status"
            [class.available]="item.availability.status === 'available'"
            [class.out-of-stock]="item.availability.status === 'out_of_stock'"
            [class.coming-soon]="item.availability.status === 'coming_soon'">
        {{item.availability.status === 'available' ? 'In Stock' : item.availability.status === 'out_of_stock' ? 'Out of Stock' : 'Coming Soon'}}
      </span>
    </div>
    
    <h3 class="item-name">{{item.name}}</h3>
    
    <!-- Category -->
    <span class="item-category-small" *ngIf="item.category">{{item.category}}</span>
    
    <p class="item-description">{{item.description}}</p>
    
    <div class="item-footer">
      <div class="item-stats">
        <div class="stat-item">
          <span class="stat-count">₹{{item.price || 0}}</span>
          <span class="stat-label">Price</span>
        </div>
        <div class="stat-item">
          <span class="stat-count">{{getReviewCount()}}</span>
          <span class="stat-label">Reviews</span>
        </div>
      </div>
      
      <button 
        *ngIf="showReviewButton()"
        [class]="getReviewButtonClass()" 
        (click)="onReviewAction($event)"
      >
        {{getReviewButtonText()}}
      </button>
      
      <span *ngIf="isOwner" class="owner-label">
        Your Item
      </span>
    </div>
  </div>
</div>
