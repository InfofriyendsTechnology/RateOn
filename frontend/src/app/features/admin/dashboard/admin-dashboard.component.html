<div class="admin-dashboard">

  <!-- Header -->
  <div class="dash-header">
    <div class="header-left">
      <div class="header-icon">
        <lucide-icon [img]="ShieldCheck" [size]="22"></lucide-icon>
      </div>
      <div class="header-text">
        <h1>Dashboard</h1>
        <p class="subtitle">{{ todayDate }}</p>
      </div>
    </div>
    <div class="header-right">
      <button class="btn-refresh" (click)="loadData()" [disabled]="isLoading">
        <lucide-icon [img]="TrendingUp" [size]="14"></lucide-icon>
        Refresh
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading...</p>
  </div>

  <ng-container *ngIf="!isLoading">

    <!-- ─── STAT CARDS ─── -->
    <div class="stat-cards">
      <div class="stat-card">
        <div class="stat-icon c-blue"><lucide-icon [img]="Users" [size]="24"></lucide-icon></div>
        <div class="stat-body">
          <div class="stat-val">{{ userAnalytics?.total?.allUsers || 0 }}</div>
          <div class="stat-lbl">Total Users</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon c-orange"><lucide-icon [img]="ShieldCheck" [size]="24"></lucide-icon></div>
        <div class="stat-body">
          <div class="stat-val">{{ userAnalytics?.total?.businessOwners || 0 }}</div>
          <div class="stat-lbl">Business Owners</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon c-purple"><lucide-icon [img]="Building2" [size]="24"></lucide-icon></div>
        <div class="stat-body">
          <div class="stat-val">{{ contentAnalytics?.businesses?.total || 0 }}</div>
          <div class="stat-lbl">Businesses</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon c-green"><lucide-icon [img]="FileText" [size]="24"></lucide-icon></div>
        <div class="stat-body">
          <div class="stat-val">{{ contentAnalytics?.reviews?.total || 0 }}</div>
          <div class="stat-lbl">Reviews</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon c-yellow"><lucide-icon [img]="TrendingUp" [size]="24"></lucide-icon></div>
        <div class="stat-body">
          <div class="stat-val">{{ contentAnalytics?.items?.total || 0 }}</div>
          <div class="stat-lbl">Items</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon c-teal"><lucide-icon [img]="UserCheck" [size]="24"></lucide-icon></div>
        <div class="stat-body">
          <div class="stat-val">{{ userAnalytics?.growth?.last7Days || 0 }}</div>
          <div class="stat-lbl">New (7 days)</div>
        </div>
      </div>
    </div>

    <!-- ─── TOP BUSINESSES ─── -->
    <div class="section-card" *ngIf="topBusinesses.length > 0">
      <app-top-businesses
        [businesses]="topBusinesses"
        [selectedPeriod]="selectedPeriod"
        (periodChange)="onPeriodChange($event)">
      </app-top-businesses>
    </div>

  </ng-container>

</div>
