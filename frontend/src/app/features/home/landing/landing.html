<div class="landing-page">
  <app-navbar></app-navbar>

  <!-- Home Dashboard â€” shown only when logged in -->
  <div *ngIf="isLoggedIn" class="home-dashboard">

    <!-- Hero Banner -->
    <div class="dash-hero">
      <div class="dash-hero-grid">
        <svg viewBox="0 0 1200 260" preserveAspectRatio="xMidYMid slice" width="100%" height="100%">
          <defs>
            <pattern id="hero-grid" width="30" height="30" patternUnits="userSpaceOnUse">
              <rect width="30" height="30" fill="none" stroke="rgba(251,191,36,0.1)" stroke-width="0.5"/>
            </pattern>
          </defs>
          <rect width="1200" height="260" fill="url(#hero-grid)" />
        </svg>
      </div>

      <div class="dash-hero-content">
        <div class="dash-hero-profile">
          <div class="dash-hero-avatar">
            <img *ngIf="user?.avatar && !avatarFailed" [src]="user.avatar" (error)="onAvatarError()" alt="Profile" referrerpolicy="no-referrer" crossorigin="anonymous" />
            <div *ngIf="!user?.avatar || avatarFailed" class="dash-hero-initial">{{ getInitial() }}</div>
          </div>
          <div class="dash-hero-info">
            <p class="dash-hero-greeting">{{ greeting || 'Welcome back' }} ðŸ‘‹</p>
            <h1 class="dash-hero-name">{{ user?.firstName || user?.username || 'User' }}<span *ngIf="user?.lastName"> {{ user.lastName }}</span></h1>
            <p class="dash-hero-email">{{ user?.email }}</p>
          </div>
        </div>
        <button class="dash-btn-review" (click)="writeReview()">
          <lucide-icon [img]="Edit" [size]="18"></lucide-icon>
          Write a Review
        </button>
      </div>

    </div>

    <!-- Quick Actions -->
    <div class="dash-actions">
      <p class="dash-section-title">Quick Actions</p>
      <div class="dash-actions-grid">
        <button class="dash-action-btn" (click)="writeReview()">
          <lucide-icon [img]="Edit" [size]="24"></lucide-icon>
          <span>Write Review</span>
        </button>
        <button class="dash-action-btn" (click)="navigateToExplore()">
          <lucide-icon [img]="Compass" [size]="24"></lucide-icon>
          <span>Explore</span>
        </button>
        <button class="dash-action-btn" (click)="navigateToProfile()">
          <lucide-icon [img]="User" [size]="24"></lucide-icon>
          <span>My Profile</span>
        </button>
        <button class="dash-action-btn" (click)="viewAllBusinesses()">
          <lucide-icon [img]="Search" [size]="24"></lucide-icon>
          <span>Search</span>
        </button>
      </div>
    </div>

  </div>

  <!-- Hero Section with Search -->
  <section class="hero-section" *ngIf="!isLoggedIn">
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <h1 class="hero-title">Review What Matters</h1>
      <p class="hero-tagline">Rate specific items, not just businesses. Build trust through transparency and honest feedback.</p>
      
      <!-- Prominent Search Bar -->
      <div class="hero-search">
        <app-search-bar (search)="onSearch($event)"></app-search-bar>
      </div>
      
      <div class="hero-stats">
        <div class="stat-item">
          <lucide-icon [img]="Building2" [size]="24"></lucide-icon>
          <span>{{ totalBusinesses }}+ Businesses</span>
        </div>
        <div class="stat-item">
          <lucide-icon [img]="Package" [size]="24"></lucide-icon>
          <span>{{ totalItems }}+ Items</span>
        </div>
        <div class="stat-item">
          <lucide-icon [img]="Star" [size]="24"></lucide-icon>
          <span>{{ totalReviews }}+ Reviews</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Businesses Section -->
  <section class="section featured-businesses">
    <div class="container">
      <div class="section-header">
        <h2>Featured Businesses</h2>
        <p class="section-subtitle">Discover top-rated places in your area</p>
      </div>
      
      <div *ngIf="loadingBusinesses" class="loading-grid">
        <div class="skeleton-card" *ngFor="let i of [1,2,3,4,5,6]">
          <div class="skeleton-image"></div>
          <div class="skeleton-content">
            <div class="skeleton-line skeleton-title"></div>
            <div class="skeleton-line skeleton-subtitle"></div>
            <div class="skeleton-line skeleton-text"></div>
          </div>
        </div>
      </div>
      
      <div *ngIf="!loadingBusinesses && featuredBusinesses.length > 0" class="businesses-grid">
        <app-business-card 
          *ngFor="let business of featuredBusinesses"
          [business]="business">
        </app-business-card>
      </div>
      
      <div *ngIf="!loadingBusinesses && featuredBusinesses.length === 0" class="empty-state">
        <p>No businesses found</p>
      </div>
      
      <div class="section-footer">
        <button class="btn btn-outline btn-lg" (click)="viewAllBusinesses()">
          View All Businesses
          <lucide-icon [img]="Building2" [size]="20"></lucide-icon>
        </button>
      </div>
    </div>
  </section>

  <!-- Featured Items Section -->
  <section class="section featured-items">
    <div class="container">
      <div class="section-header">
        <h2>Featured Items</h2>
        <p class="section-subtitle">Popular items reviewed by our community</p>
      </div>
      
      <div *ngIf="loadingItems" class="loading-grid">
        <div class="skeleton-card" *ngFor="let i of [1,2,3,4,5,6]">
          <div class="skeleton-image"></div>
          <div class="skeleton-content">
            <div class="skeleton-line skeleton-title"></div>
            <div class="skeleton-line skeleton-subtitle"></div>
            <div class="skeleton-line skeleton-text"></div>
          </div>
        </div>
      </div>
      
      <div *ngIf="!loadingItems && featuredItems.length > 0" class="items-grid">
        <app-item-card 
          *ngFor="let item of featuredItems"
          [item]="item"
          (cardClick)="router.navigate(['/item', $event._id])">
        </app-item-card>
      </div>
      
      <div *ngIf="!loadingItems && featuredItems.length === 0" class="empty-state">
        <p>No items found</p>
      </div>
      
      <div class="section-footer">
        <button class="btn btn-outline btn-lg" (click)="viewAllItems()">
          View All Items
          <lucide-icon [img]="Package" [size]="20"></lucide-icon>
        </button>
      </div>
    </div>
  </section>

  <!-- What is RateOn -->
  <section class="section what-is" *ngIf="!isLoggedIn">
    <div class="container">
      <div class="section-header">
        <h2>What is RateOn?</h2>
        <p class="section-subtitle">A new approach to reviews</p>
      </div>
      <div class="content-grid">
        <div class="content-block">
          <lucide-icon [img]="Target" [size]="32"></lucide-icon>
          <h3>Item-Specific Reviews</h3>
          <p>Review individual products and services, not just businesses. Get precise feedback on what matters.</p>
        </div>
        <div class="content-block">
          <lucide-icon [img]="Shield" [size]="32"></lucide-icon>
          <h3>Verified Trust System</h3>
          <p>Build your reputation through quality reviews. Earn trust scores based on helpfulness and accuracy.</p>
        </div>
        <div class="content-block">
          <lucide-icon [img]="Users" [size]="32"></lucide-icon>
          <h3>Community Driven</h3>
          <p>Connect with real reviewers. Help others make informed decisions through shared experiences.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- How It Works -->
  <section class="section how-it-works" *ngIf="!isLoggedIn">
    <div class="container">
      <div class="section-header">
        <h2>How It Works</h2>
        <p class="section-subtitle">Simple, transparent, effective</p>
      </div>
      <div class="steps">
        <div class="step">
          <div class="step-number">1</div>
          <h3>Find Items</h3>
          <p>Search for specific products or services you want to review or explore.</p>
        </div>
        <div class="step">
          <div class="step-number">2</div>
          <h3>Share Experience</h3>
          <p>Write detailed reviews with ratings, photos, and helpful insights.</p>
        </div>
        <div class="step">
          <div class="step-number">3</div>
          <h3>Build Trust</h3>
          <p>Earn reputation through quality contributions and help others decide.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section class="section features" *ngIf="!isLoggedIn">
    <div class="container">
      <div class="section-header">
        <h2>Features</h2>
        <p class="section-subtitle">Everything you need to share and discover</p>
      </div>
      <div class="features-grid">
        <div class="feature-card">
          <lucide-icon [img]="Star" [size]="28"></lucide-icon>
          <h3>Detailed Ratings</h3>
          <p>Rate items on multiple dimensions for comprehensive feedback.</p>
        </div>
        <div class="feature-card">
          <lucide-icon [img]="Image" [size]="28"></lucide-icon>
          <h3>Photo Reviews</h3>
          <p>Add images to your reviews to show real experiences.</p>
        </div>
        <div class="feature-card">
          <lucide-icon [img]="MessageSquare" [size]="28"></lucide-icon>
          <h3>Business Responses</h3>
          <p>Direct communication between reviewers and businesses.</p>
        </div>
        <div class="feature-card">
          <lucide-icon [img]="TrendingUp" [size]="28"></lucide-icon>
          <h3>Trust Score</h3>
          <p>Build credibility through consistent, helpful reviews.</p>
        </div>
        <div class="feature-card">
          <lucide-icon [img]="Search" [size]="28"></lucide-icon>
          <h3>Smart Search</h3>
          <p>Find exactly what you're looking for with advanced filters.</p>
        </div>
        <div class="feature-card">
          <lucide-icon [img]="Building2" [size]="28"></lucide-icon>
          <h3>Business Tools</h3>
          <p>Manage items, respond to reviews, and build your brand.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- For Businesses -->
  <section class="section for-businesses" *ngIf="!isLoggedIn">
    <div class="container">
      <div class="section-header">
        <h2>For Business Owners</h2>
        <p class="section-subtitle">Manage your reputation effectively</p>
      </div>
      <div class="business-features">
        <div class="business-card">
          <lucide-icon [img]="Package" [size]="32"></lucide-icon>
          <h3>Item Management</h3>
          <p>Add and manage your products or services. Keep information accurate and up-to-date.</p>
        </div>
        <div class="business-card">
          <lucide-icon [img]="Bell" [size]="32"></lucide-icon>
          <h3>Review Notifications</h3>
          <p>Get instant alerts when customers review your items. Stay responsive and engaged.</p>
        </div>
        <div class="business-card">
          <lucide-icon [img]="BarChart3" [size]="32"></lucide-icon>
          <h3>Analytics Dashboard</h3>
          <p>Track performance, understand feedback trends, and improve your offerings.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Why Choose RateOn -->
  <section class="section why-choose" *ngIf="!isLoggedIn">
    <div class="container">
      <div class="section-header">
        <h2>Why Choose RateOn?</h2>
        <p class="section-subtitle">What makes us different</p>
      </div>
      <div class="reasons">
        <div class="reason">
          <lucide-icon [img]="CheckCircle2" [size]="24"></lucide-icon>
          <div>
            <h3>Granular Reviews</h3>
            <p>Review specific items, not entire businesses. More precise, more useful.</p>
          </div>
        </div>
        <div class="reason">
          <lucide-icon [img]="CheckCircle2" [size]="24"></lucide-icon>
          <div>
            <h3>Trust-Based System</h3>
            <p>Reviewers earn credibility. Quality matters more than quantity.</p>
          </div>
        </div>
        <div class="reason">
          <lucide-icon [img]="CheckCircle2" [size]="24"></lucide-icon>
          <div>
            <h3>Transparent Platform</h3>
            <p>No hidden agendas. Real reviews from real people.</p>
          </div>
        </div>
        <div class="reason">
          <lucide-icon [img]="CheckCircle2" [size]="24"></lucide-icon>
          <div>
            <h3>Easy to Use</h3>
            <p>Clean interface. Simple process. Get started in seconds.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="section cta">
    <div class="container">
      <h2 *ngIf="!isLoggedIn">Start Reviewing Today</h2>
      <h2 *ngIf="isLoggedIn">Ready to Share Your Experience?</h2>
      <p *ngIf="!isLoggedIn">Join our community and make your voice heard</p>
      <p *ngIf="isLoggedIn">Find businesses and items to review</p>
      <div class="cta-actions">
        <a *ngIf="!isLoggedIn" routerLink="/auth/register" class="btn btn-primary btn-lg">
          <lucide-icon [img]="UserPlus" [size]="22"></lucide-icon>
          <span>Create Free Account</span>
        </a>
        <button *ngIf="isLoggedIn" class="btn btn-primary btn-lg" (click)="viewAllBusinesses()">
          <lucide-icon [img]="Search" [size]="22"></lucide-icon>
          <span>Explore & Review</span>
        </button>
      </div>
    </div>
  </section>

  <!-- Footer - Simple, No Header Structure -->
  <footer class="footer">
    <div class="footer-center">
      <img 
        *ngIf="themeService.isDarkMode()" 
        src="/LOGO_WHITE.png" 
        alt="RateOn" 
        class="footer-logo" 
        (click)="onLogoClick()"
      />
      <img 
        *ngIf="!themeService.isDarkMode()" 
        src="/LOGO_BLACK.png" 
        alt="RateOn" 
        class="footer-logo" 
        (click)="onLogoClick()"
      />
      <p class="footer-tagline">Honest reviews. Real impact.</p>
      <div class="footer-links">
        <a routerLink="/explore">Explore</a>
        <span class="separator">â€¢</span>
        <a routerLink="/auth/login">Login</a>
        <span class="separator">â€¢</span>
        <a routerLink="/auth/register">Sign Up</a>
        <span class="separator">â€¢</span>
        <a href="#">Privacy</a>
        <span class="separator">â€¢</span>
        <a href="#">Terms</a>
      </div>
      <p class="footer-copyright">&copy; 2026 RateOn. All rights reserved.</p>
    </div>
  </footer>
</div>

