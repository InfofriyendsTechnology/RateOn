<div class="search-results-page">
  <div class="search-content">
      <!-- Results Section -->
    <main class="results-section">
      
      <!-- Combined Header with Search and Title -->
      <div class="results-header">
        <!-- Navigation Row -->
        <div class="nav-row">
          <div class="nav-breadcrumb-section">
            <app-breadcrumbs [crumbs]="breadcrumbs"></app-breadcrumbs>
          </div>
          
          <div class="header-actions">
            <div class="search-bar-compact">
              <app-search-bar 
                (search)="onSearchChange($event)">
              </app-search-bar>
            </div>
            
            <button 
              class="theme-toggle-btn" 
              (click)="toggleTheme()" 
              [attr.aria-label]="themeService.isDarkMode() ? 'Switch to light mode' : 'Switch to dark mode'">
              <lucide-icon *ngIf="themeService.isDarkMode()" [img]="Sun" [size]="20"></lucide-icon>
              <lucide-icon *ngIf="!themeService.isDarkMode()" [img]="Moon" [size]="20"></lucide-icon>
            </button>
          </div>
        </div>
        
        <!-- Title Row -->
        <div class="title-row">
          <h1 class="results-title">Explore</h1>
          <p class="results-count">{{ totalResults }} results</p>
        </div>

        <!-- Tabs -->
        <div class="tabs">
          <button 
            class="tab-btn"
            [class.active]="activeTab === 'businesses'"
            (click)="onTabChange('businesses')">
            <i class="lucide lucide-building-2"></i>
            <span>Businesses</span>
          </button>
          <button 
            class="tab-btn"
            [class.active]="activeTab === 'items'"
            (click)="onTabChange('items')">
            <i class="lucide lucide-shopping-bag"></i>
            <span>Items</span>
          </button>
        </div>
      </div>

      <!-- Loading State with Skeletons -->
      @if (loading && businesses.length === 0 && items.length === 0) {
        <div class="results-grid">
          @for (i of [1,2,3,4,5,6,7,8,9,10]; track i) {
            <div class="skeleton-card">
              <div class="skeleton-image"></div>
              <div class="skeleton-content">
                <div class="skeleton-title"></div>
                <div class="skeleton-text"></div>
                <div class="skeleton-text short"></div>
              </div>
            </div>
          }
        </div>
      }

      <!-- Results Grid -->
      @if (!loading && activeTab === 'businesses' && businesses.length > 0) {
        <div class="results-grid">
          @for (business of businesses; track business.id) {
            <app-business-card 
              [business]="business"
              [hasUserReview]="hasUserReviewedBusiness(business.id)"></app-business-card>
          }
        </div>
      }

      @if (!loading && activeTab === 'items' && items.length > 0) {
        <div class="results-grid">
          @for (item of items; track item.id) {
            <app-item-card 
              [item]="transformItemForCard(item)"
              [hasUserReview]="hasUserReviewedItem(item.id)"
              (reviewAction)="onItemReviewAction($event)"
              (cardClick)="onItemCardClick($event)"></app-item-card>
          }
        </div>
      }

      <!-- No Results -->
      @if (!loading && ((activeTab === 'businesses' && businesses.length === 0) || 
                         (activeTab === 'items' && items.length === 0))) {
        <div class="no-results">
          <i class="lucide lucide-search-x"></i>
          <h2>No results found</h2>
          <p>Try adjusting your search or filters</p>
        </div>
      }

      <!-- Load More -->
      @if ((activeTab === 'businesses' ? businesses.length < totalResults : items.length < totalResults)) {
        <div class="load-more-section">
          <button class="load-more-btn" (click)="loadMore()">
            <span>Load More</span>
            <i class="lucide lucide-chevron-down"></i>
          </button>
        </div>
      }

    </main>
  </div>
</div>
