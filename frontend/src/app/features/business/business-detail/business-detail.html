<div class="business-detail-container" *ngIf="!loading && business">
  <!-- Breadcrumbs -->
  <div class="page-header">
    <app-breadcrumbs [crumbs]="[
      { label: 'Dashboard', link: '/business/dashboard' },
      { label: 'Businesses', link: '/business/dashboard/businesses' },
      { label: 'Business' }
    ]"></app-breadcrumbs>
  </div>
  
  <!-- Business Info Header -->
  <div class="business-info-header">
    <div class="business-logo" *ngIf="business.logo; else logoPlaceholder">
      <img [src]="business.logo" [alt]="business.name" />
    </div>
    <ng-template #logoPlaceholder>
      <div class="business-logo placeholder">
        <lucide-icon [img]="Building" [size]="48"></lucide-icon>
      </div>
    </ng-template>
    <div class="business-header-content">
      <h1 class="business-name">{{ business.name }}</h1>
      <div class="business-meta">
        <span class="category-badge">{{ business.category || business.type }}</span>
        <div class="rating-stars" *ngIf="business.rating">
          <span class="stars">
            <lucide-icon *ngFor="let star of [1,2,3,4,5]" 
              [img]="Star" 
              [size]="18"
              [attr.fill]="getStarFill(star, business.rating)"
              [style.color]="getStarColor(star, business.rating)"></lucide-icon>
          </span>
          <span class="rating-text">{{ business.rating.toFixed(1) }}</span>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Summary Card -->
  <div class="summary-card">
    <div class="summary-grid">
      <!-- About Section -->
      <div class="summary-section" *ngIf="business.description">
        <h3>
          <lucide-icon [img]="Info" [size]="18"></lucide-icon>
          About
        </h3>
        <p>{{ business.description }}</p>
      </div>
      
      <!-- Stats -->
      <div class="summary-section">
        <h3>
          <lucide-icon [img]="Package" [size]="18"></lucide-icon>
          Quick Info
        </h3>
        <div class="summary-stats">
          <div class="stat-item" *ngIf="business.stats?.totalItems !== undefined">
            <span class="stat-label">Items</span>
            <span class="stat-value">{{ business.stats.totalItems || 0 }}</span>
          </div>
          <div class="stat-item" *ngIf="business.stats?.totalReviews !== undefined">
            <span class="stat-label">Reviews</span>
            <span class="stat-value">{{ business.stats.totalReviews || 0 }}</span>
          </div>
          <div class="stat-item" *ngIf="business.rating">
            <span class="stat-label">Rating</span>
            <span class="stat-value">{{ business.rating.toFixed(1) }}</span>
          </div>
        </div>
      </div>
      
      <!-- Contact -->
      <div class="summary-section">
        <h3>
          <lucide-icon [img]="Phone" [size]="18"></lucide-icon>
          Contact
        </h3>
        <div class="info-list">
          <div class="info-item" *ngIf="business.location?.address">
            <lucide-icon [img]="MapPin" [size]="14"></lucide-icon>
            <span>{{ business.location.city }}, {{ business.location.state }}</span>
          </div>
          <div class="info-item" *ngIf="business.contact?.phone">
            <lucide-icon [img]="Phone" [size]="14"></lucide-icon>
            <a [href]="'tel:' + business.contact.phone">{{ business.contact.phone }}</a>
          </div>
          <div class="info-item" *ngIf="business.contact?.email">
            <lucide-icon [img]="Globe" [size]="14"></lucide-icon>
            <a [href]="'mailto:' + business.contact.email">{{ business.contact.email }}</a>
          </div>
        </div>
      </div>
      
      <!-- Hours -->
      <div class="summary-section" *ngIf="business.businessHours?.length">
        <h3>
          <lucide-icon [img]="Clock" [size]="18"></lucide-icon>
          Hours
        </h3>
        <div class="hours-compact">
          <div class="hour-item" *ngFor="let h of (showAllHours ? business.businessHours : business.businessHours.slice(0, 3))">
            <span class="day">{{ h.day.substring(0, 3) | titlecase }}</span>
            <span class="time" *ngIf="!h.isClosed">{{ formatTime(h.open) }} - {{ formatTime(h.close) }}</span>
            <span class="closed" *ngIf="h.isClosed">Closed</span>
          </div>
          <button class="see-all" *ngIf="business.businessHours.length > 3" (click)="showAllHours = !showAllHours">
            {{ showAllHours ? 'Show less' : 'See all hours' }}
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Horizontal Photo Gallery -->
  <div class="photos-section" *ngIf="business.coverImages?.length">
    <div class="photos-header">
      <h3>Photos</h3>
      <button class="view-all-btn" (click)="showAllPhotos = !showAllPhotos">
        <lucide-icon [img]="showAllPhotos ? ChevronUp : ImageIcon" [size]="18"></lucide-icon>
        <span>{{ showAllPhotos ? 'Show less' : 'View all ' + business.coverImages.length + ' photos' }}</span>
      </button>
    </div>
    
    <div class="photos-horizontal" *ngIf="!showAllPhotos">
      <div class="photo-thumb" *ngFor="let img of business.coverImages.slice(0, 6)">
        <img [src]="img" [alt]="business.name" />
      </div>
    </div>
    
    <div class="photos-grid-full" *ngIf="showAllPhotos">
      <div class="photo-item-full" *ngFor="let img of business.coverImages">
        <img [src]="img" [alt]="business.name" />
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <a [routerLink]="['/business/dashboard/edit', business._id]" class="action-btn btn-secondary">
      <lucide-icon [img]="Edit" [size]="20"></lucide-icon>
      <span>Edit Business</span>
    </a>
    <a [routerLink]="['/business/dashboard/items', business._id]" class="action-btn btn-primary">
      <lucide-icon [img]="Package" [size]="20"></lucide-icon>
      <span>Manage Items</span>
    </a>
  </div>
</div>

<div class="loading-state" *ngIf="loading">
  <div class="spinner"></div>
  <p>Loading business details...</p>
</div>
